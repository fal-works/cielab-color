function createCielabToXyzFunc(){return r=>r>6/29?r*r*r:6/29*3*(6/29)*(r-16/116)}function cielabValueToXyzValue(r,n,a){const l=(r[0]+16)/116,t=l+r[1]/500,e=l-r[2]/200;return a?(a[0]=n.tristimulusValues[0]*cielabToXyzFunc(t),a[1]=n.tristimulusValues[1]*cielabToXyzFunc(l),a[2]=n.tristimulusValues[2]*cielabToXyzFunc(e),a):[n.tristimulusValues[0]*cielabToXyzFunc(t),n.tristimulusValues[1]*cielabToXyzFunc(l),n.tristimulusValues[2]*cielabToXyzFunc(e)]}function multiplyMatrixAndArray(r,n,a){const l=r.length,t=r[0].length,e=a||new Array(l);for(let a=0;a<l;a+=1){e[a]=0;for(let l=0;l<t;l+=1)e[a]+=r[a][l]*n[l]}return e}function degamma(r){return r<=.0031308?12.92*r:1.055*Math.pow(r,1/2.4)-.055}function setIlluminant(r){currentIlluminant=r}function assignArray(r,n,a,l){return r[0]=n,r[1]=a,r[2]=l,r}function linearRgbFactorToSrgbValue(r){return 255*degamma(Math.min(Math.max(r,0),1))}function cielabColor(r,n,a,l){const t=cielabValueToXyzValue(assignArray(temporalArray1,r,n,a),currentIlluminant,temporalArray2),e=multiplyMatrixAndArray(xyzToLinearRgbConversionMatrix,t,temporalArray3),i=assignArray(temporalArray4,linearRgbFactorToSrgbValue(e[0]),linearRgbFactorToSrgbValue(e[1]),linearRgbFactorToSrgbValue(e[2]));return l?[i[0],i[1],i[2],l]:[i[0],i[1],i[2]]}function cielchColor(r,n,a,l){return cielabColor(r,n*Math.cos(a),n*Math.sin(a),l)}const cielabToXyzFunc=createCielabToXyzFunc(),xyzToLinearRgbConversionMatrix=[[3.2406255,-1.537208,-.4986286],[-.9689307,1.8757561,.0415175],[.0557101,-.2040211,1.0569959]];class Illuminant{constructor(r,n){this.name=r,this.tristimulusValues=n}}const illuminants={D50:new Illuminant("D50",[.9642,1,.8251]),D55:new Illuminant("D55",[.9568,1,.9214]),D65:new Illuminant("D65",[.95047,1,1.08883]),E:new Illuminant("E",[1,1,1])};let currentIlluminant=illuminants.D50;const temporalArray1=[0,0,0],temporalArray2=[0,0,0],temporalArray3=[0,0,0],temporalArray4=[0,0,0];export{setIlluminant,cielabColor,cielchColor,illuminants};